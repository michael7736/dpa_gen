# DPA 智能知识引擎 - 产品需求文档 (PRD)

> **版本**: v0.8  
> **更新日期**: 2025年7月4日  
> **状态**: MVP阶段 - 80%完成度  
> **环境**: Python 3.11.5 + LangChain 0.3.26 + LangGraph 0.4.8

## 1. 产品概述

### 1.1 产品愿景
构建一个能作为研究者和商务分析员"AI研究合伙人"的智能知识引擎，通过深度分析和智能交互，将海量、复杂的学术文献、商务文档与技术手册，转化为结构化的知识和可行动的洞察。

### 1.2 产品一句话定位 (Slogan)
**您的AI研究合伙人，将百篇论文提炼为一篇洞察报告。**

### 1.3 产品定位
- **核心定位**: 个人的AI研究助理与知识发现引擎
- **目标用户**  
  - **核心种子用户:** 高级律师、合伙人、企业关键战略决策者、博士生、进行文献综述的研究人员
  - **拓展用户:** 高级工程师、技术决策者
- **应用场景**  
  - **初期核心场景:** 单篇/多篇论文的深度精读与分析
  - **长期场景:** 项目型任务、文献综述、技术调研、构建团队知识库、辅助研究规划
- **反面画像 (Anti-Persona):** 本产品不服务于寻求简单、现成答案而不愿探究原文的初级用户

---

## 2. 用户画像与需求分析

### 2.1 主要用户群体

#### 2.1.1 核心用户群体
1. **高级研究人员**
   - 博士生、博士后研究员
   - 科研院所研究员
   - 企业R&D负责人

2. **专业服务人员**
   - 律师事务所合伙人
   - 咨询公司分析师
   - 投资机构研究员

3. **技术决策者**
   - CTO、技术总监
   - 高级工程师
   - 产品经理

### 2.2 用户故事 (User Stories)

#### 核心用户故事
1. **企业 IPO 律师 – 尽职调查工作流**  
   - **IPO 尽职报告撰写**：研究上市法律条款和流程规范；审阅财报、年报等材料；形成尽职调查报告并评估风险与改进方案
   - **项目筹备**：分析上市流程与案例，生成材料清单、整体规划及阶段性评估指标
   - **材料审计**：结合第三方数据源，评估材料的完整性、准确性、真实性与合规性
   - **报告输出**：结合法条与企业材料撰写并审阅最终报告

2. **材料科学博士生**  
   > 上传 30 篇"钙钛矿太阳能电池稳定性"论文 → 自动抽取实验方法、性能指标和衰减机制；可视化权威学者、技术路线优劣，帮助确定研究切入点

3. **AI 算法工程师**  
   > 上传 LoRA 核心及改进论文 → 就公式、实验设置、结论进行对话式提问并获得溯源回答，缩短学习曲线

4. **科技公司技术负责人**  
   > 构建"联邦学习"共享知识库 → 当询问隐私风险时，系统基于团队知识给出综合回答并链接到讨论与原始文献

---

## 3. 功能需求

### 3.1 核心功能模块

#### 3.1.1 层次化知识索引系统 (基石)
**功能描述：** 对文档（含项目目录）进行多层次、多维度解析与索引，作为所有上层应用基础。

| 阶段 | 关键能力 | 实现状态 |
| --- | --- | --- |
| **P0 (MVP 必备)** | - **文档解析与画像**：全文主题摘要、发布时间、作者、引用关系、关键字、目录、分类标签等元数据<br> - **高精度文本提取**：保证多栏论文、章节文本准确<br> - **内容语义索引**：段落/句子级向量化<br> - **项目目录索引**：将文件层级关系与向量检索整合<br> - **跨文档概念融合** | ✅ 已实现<br>✅ 已实现<br>✅ 已实现<br>✅ 已实现<br>✅ 已实现 |
| **P1 (Beta)** | - **表格内容提取** 与索引<br> - **实体关系抽取**：图数据库存储概念及关系 | ✅ 已实现<br>✅ 已实现 |
| **P2 (正式版+)** | - **公式识别与索引**（LaTeX/图像）<br> - **跨文档概念深度融合**<br> - **图表语义索引（探索）** | 🔄 规划中<br>🔄 规划中<br>🔄 规划中 |

#### 3.1.2 智能问答与分析系统 (核心交互)
**功能描述：** 提供从简单查询到复杂规划的对话能力。

| 阶段 | 关键能力 | 实现状态 |
| --- | --- | --- |
| **P0 (MVP)** | - **单文档 Q&A**<br> - **精准溯源**（可点击高亮）<br> - **核心摘要**（一句话 + 结构化）<br> - **外部关系拓展阅读** | ✅ 已实现<br>✅ 已实现<br>✅ 已实现<br>🟡 开发中 |
| **P1 (Beta)** | - **跨文档 Q&A**<br> - **多轮对话**（上下文记忆）<br> - **对比性分析** | ✅ 已实现<br>✅ 已实现<br>🟡 开发中 |
| **P2 (正式版+)** | - **洞察报告生成**（异步）<br> - **假设性问题探讨** | 🔄 规划中<br>🔄 规划中 |

#### 3.1.3 项目记忆库系统 (核心壁垒)
**功能描述：** 为每个研究项目建立独立、持续进化的记忆库，让 AI 由"工具"变"伙伴"。

| 阶段 | 关键能力 | 实现状态 |
| --- | --- | --- |
| **技术基线** | 不依赖模型微调；使用向量/图/结构化数据库存储用户交互与反馈，作为高优先级上下文注入 Prompt（参考 LangChain）。 | ✅ 架构完成 |
| **P1 (Beta)** | - **项目隔离**（ID 体系）<br> - **项目/短期/原始记忆分层**<br> - **用户反馈记忆**（赞/踩、错题本）<br> - **跨会话对话历史** | ✅ 已实现<br>✅ 已实现<br>🟡 开发中<br>✅ 已实现 |
| **P2 (正式版+)** | - **标注与笔记记忆**<br> - **知识演化视图** | 🔄 规划中<br>🔄 规划中 |

#### 3.1.4 研究项目规划和管理系统 (高级功能)
| 阶段 | 关键能力 | 实现状态 |
| --- | --- | --- |
| **P1** | - **项目规划模板**（港股/A 股/美股上市等）<br> - **规划调整与执行跟踪** | 🔄 规划中<br>🔄 规划中 |
| **P2** | - **研究主题分析**（大纲 + 必读列表）<br> - **交互式路径规划**（拖拽修改）<br> - **进度跟踪与提醒** | 🔄 规划中<br>🔄 规划中<br>🔄 规划中 |

### 3.2 辅助功能模块
- **可视化分析（P1）**：知识图谱、研究进展时间线  
- **协作与分享（P2）**：团队知识库共享、成果导出（Markdown/PDF）、标注评论

---

## 4. 非功能性需求

### 4.1 性能要求
- **响应时间**：简单问答 < 2 s；跨文档分析 < 10 s  
- **异步任务**：> 30 s 报告采用异步，完成后通知用户  
- **并发处理**：支持100+并发用户
- **存储容量**：单项目支持10GB文档，系统总容量1TB+

### 4.2 可用性与安全性
- **系统可用性**：99.5 %+  
- **UI**：直观易用，响应式设计
- **数据安全**：支持本地化/私有云部署
- **隐私保护**：项目级数据隔离，端到端加密

### 4.3 技术性能指标
- **文档处理速度**：100页PDF < 30s
- **向量检索延迟**：< 100ms
- **知识图谱查询**：< 500ms
- **内存使用**：< 8GB (单实例)

---

## 5. 技术约束与架构

### 5.1 核心技术栈

| 模块 | 选型 | 版本 |
| --- | --- | --- |
| **后端框架** | Python + FastAPI | Python 3.11.5, FastAPI 0.115.13+ |
| **前端** | Next.js + TypeScript + Tailwind | Next.js 14+ |
| **AI框架** | LangChain + LangGraph + LangSmith | LangChain 0.3.26+, LangGraph 0.4.8+ |
| **数据库** | PostgreSQL + Qdrant + Neo4j + Redis | PostgreSQL 16+, Qdrant 1.14.3+ |
| **大模型** | OpenAI + Anthropic + OpenRouter | GPT-4o, Claude-3.5-Sonnet |
| **部署** | Docker + Conda | Docker Compose, dpa_gen环境 |
| **监控** | LangSmith + Structlog | LangSmith 0.4.1+, Structlog 25.4.0+ |

### 5.2 开发环境配置
- **Conda环境**: `dpa_gen` (Python 3.11.5)
- **依赖管理**: requirements.txt + environment.yml
- **服务器配置**: rtx4080 (数据库、向量库、缓存)
- **API密钥**: OpenAI, Anthropic, Cohere, OpenRouter已配置

### 5.3 部署架构
```
┌─────────────────────────────────────────────────────────────────┐
│                   负载均衡层 (Nginx/Traefik)                   │
├─────────────────────────────────────────────────────────────────┤
│                   应用层 (FastAPI + Uvicorn)                   │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐               │
│  │文档处理服务 │ │问答服务     │ │项目管理服务 │               │
│  │(LangGraph)  │ │(LangChain)  │ │(FastAPI)    │               │
│  └─────────────┘ └─────────────┘ └─────────────┘               │
├─────────────────────────────────────────────────────────────────┤
│                   数据层 (rtx4080 服务器)                      │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌───────────┐ │
│  │PostgreSQL   │ │Qdrant       │ │Neo4j        │ │Redis      │ │
│  │:5432        │ │:6333        │ │:7687        │ │:6379      │ │
│  └─────────────┘ └─────────────┘ └─────────────┘ └───────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

---

## 6. 成功指标

### 6.1 用户体验指标
| 指标类别 | 核心指标 | 目标 | 衡量方式 |
| --- | --- | --- | --- |
| **用户满意度** | NPS | > 40 (MVP) / > 60 (正式) | 用户问卷 |
| **功能完成率** | 核心任务完成率 | > 90 % | 监控埋点 |
| **用户留存** | 次周留存 | > 40 % (MVP) | 数据后台 |
| **使用频率** | DAU/MAU | > 30% | 用户行为分析 |

### 6.2 技术性能指标
| 指标类别 | 核心指标 | 目标 | 衡量方式 |
| --- | --- | --- | --- |
| **功能准确性** | 答案采纳率 | > 60 % | 行为埋点 |
| **效率提升** | 文献精读效率 | 时间缩短 70 % | A/B 测试 |
| **溯源准确性** | 溯源准确率 | > 98 % | 黄金测试集 |
| **响应性能** | 平均查询响应 | < 3 s | 监控系统 |

### 6.3 系统稳定性指标
- **系统可用性**: > 99.5%
- **错误率**: < 0.1%
- **平均故障恢复时间**: < 5分钟
- **数据一致性**: > 99.9%

---

## 7. 发布计划

### 7.1 MVP阶段（已完成基础架构）
**时间**: 2025年1月 - 2025年3月
**状态**: 🟡 进行中 (40%完成)

**已完成**:
- ✅ 核心架构设计和技术选型
- ✅ 开发环境配置 (dpa_gen conda环境)
- ✅ 数据模型定义 (User, Project, Document, Chunk)
- ✅ 文档解析系统 (支持PDF, Word, Markdown, Text)
- ✅ 文档分块系统 (多种策略)
- ✅ 配置管理系统 (支持多环境)

**进行中**:
- 🟡 文档处理智能体 (LangGraph工作流)
- 🟡 向量化和索引系统
- 🟡 基础API接口开发

**待完成**:
- 🔄 单文档Q&A功能
- 🔄 精准溯源功能
- 🔄 前端界面开发
- 🔄 用户认证和项目管理

### 7.2 Beta阶段（多文档研究工作台）
**时间**: 2025年4月 - 2025年6月

**主要功能**:
- 跨文档Q&A v1
- 项目记忆库 v1
- 概念关系图 v1
- 多轮对话支持
- 基础可视化

### 7.3 正式版（智能化研究助理）
**时间**: 2025年7月 - 2025年12月

**主要功能**:
- 研究路径建议系统
- 异步洞察报告生成
- 协作与分享功能
- 完善的记忆库和个性化
- 高级可视化和分析

---

## 8. 风险评估与应对

### 8.1 技术风险
| 风险类别 | 风险描述 | 影响等级 | 应对策略 |
| --- | --- | --- | --- |
| **API依赖** | 大模型API稳定性/成本/审查 | 高 | 多供应商策略、本地模型备选、成本监控 |
| **RAG准确性** | 检索幻觉、理解偏差 | 中 | 强制溯源、用户反馈闭环、黄金测试集 |
| **性能瓶颈** | 大规模文档处理性能 | 中 | 异步处理、分布式架构、缓存优化 |
| **数据安全** | 用户数据泄露风险 | 高 | 端到端加密、项目隔离、安全审计 |

### 8.2 市场风险
| 风险类别 | 风险描述 | 影响等级 | 应对策略 |
| --- | --- | --- | --- |
| **用户接受度** | 用户学习成本高 | 中 | 渐进式功能发布、用户教育、简化UI |
| **竞争压力** | 大厂产品竞争 | 高 | 深度聚焦、差异化功能、社区建设 |
| **商业模式** | 变现路径不清晰 | 中 | 多元化收费模式、企业级服务 |

### 8.3 运营风险
- **合规风险**: 建立数据合规和隐私保护机制
- **团队风险**: 关键技术人员流失预防
- **资源风险**: 计算资源成本控制和优化

---

## 9. 附录

### 9.1 技术债务管理
- 代码质量: Ruff + MyPy + 单元测试覆盖率 >85%
- 文档更新: 每个功能模块配套技术文档
- 性能监控: LangSmith + 自定义监控指标

### 9.2 用户研究计划
- 种子用户深度访谈 (每月2-3次)
- 功能使用数据分析 (每周)
- 用户满意度调研 (每季度)

### 9.3 开源策略
- 核心框架保持闭源
- 工具组件和插件考虑开源
- 社区建设和开发者生态

