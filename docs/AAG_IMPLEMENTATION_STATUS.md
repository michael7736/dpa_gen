# AAGæ¨¡å—å®æ–½çŠ¶æ€æŠ¥å‘Š

> æ›´æ–°æ—¶é—´ï¼š2025-07-14

## æ¦‚è¿°

AAG (Analysis-Augmented Generation) æ¨¡å—æ˜¯DPAç³»ç»Ÿçš„æ ¸å¿ƒåˆ†æå¼•æ“ï¼Œç›®æ ‡æ˜¯å®ç°ä»æ–‡æ¡£çš„è¡¨å±‚ä¿¡æ¯æå–åˆ°æ·±åº¦çŸ¥è¯†æ´å¯Ÿçš„å®Œæ•´åˆ†æé“¾è·¯ã€‚æœ¬æ–‡æ¡£è®°å½•AAGæ¨¡å—çš„å½“å‰å®æ–½çŠ¶æ€ã€‚

## å·²å®ŒæˆåŠŸèƒ½ âœ…

### 1. åŸºç¡€æ¶æ„æ­å»º
- âœ… AAGæ¨¡å—ç›®å½•ç»“æ„åˆ›å»º
- âœ… BaseAgentåŸºç±»å®ç°ï¼ˆæä¾›æ ‡å‡†åŒ–çš„Agentå¼€å‘æ¡†æ¶ï¼‰
- âœ… å­˜å‚¨å±‚å®ç°ï¼ˆArtifactStoreç”¨äºä¿å­˜åˆ†æç»“æœï¼ŒMetadataManagerç”¨äºç®¡ç†å…ƒæ•°æ®ï¼‰
- âœ… APIè·¯ç”±é›†æˆï¼ˆæ‰€æœ‰åŠŸèƒ½éƒ½æœ‰å¯¹åº”çš„RESTful APIï¼‰

### 2. å¿«é€Ÿç•¥è¯»åŠŸèƒ½ (SkimmerAgent)
**å®Œæˆæ—¶é—´**: 2025-07-13

**åŠŸèƒ½ç‰¹æ€§**:
- å¿«é€Ÿæå–æ–‡æ¡£æ ¸å¿ƒä¿¡æ¯ï¼ˆé™åˆ¶8000å­—ç¬¦ï¼‰
- è¯†åˆ«æ–‡æ¡£ç±»å‹ï¼ˆå­¦æœ¯è®ºæ–‡/æŠ€æœ¯æŠ¥å‘Š/å•†ä¸šæ–‡æ¡£ç­‰ï¼‰
- ç”Ÿæˆ50å­—æ ¸å¿ƒä»·å€¼æ¦‚æ‹¬
- æå–3-5ä¸ªå…³é”®è¦ç‚¹
- è¯†åˆ«ç›®æ ‡å—ä¼—
- è¯„ä¼°æ–‡æ¡£è´¨é‡ï¼ˆé«˜/ä¸­/ä½ï¼‰
- æä¾›2-3ä¸ªåç»­æ·±åº¦åˆ†æå»ºè®®

**APIç«¯ç‚¹**: `POST /api/v1/aag/skim`

### 3. æ¸è¿›å¼æ‘˜è¦åŠŸèƒ½ (ProgressiveSummaryAgent)
**å®Œæˆæ—¶é—´**: 2025-07-14

**åŠŸèƒ½ç‰¹æ€§**:
- 5ä¸ªçº§åˆ«çš„å±‚æ¬¡åŒ–æ‘˜è¦ç”Ÿæˆ
  - Level 1: 50å­—æç®€æ‘˜è¦
  - Level 2: 200å­—æ¦‚è¦ï¼ˆå¯å‚è€ƒLevel 1ï¼‰
  - Level 3: 500å­—è¯¦ç»†æ‘˜è¦ï¼ˆå¯å‚è€ƒLevel 1&2ï¼‰
  - Level 4: 1000å­—æ·±åº¦æ‘˜è¦ï¼ˆå¯å‚è€ƒLevel 2ï¼‰
  - Level 5: 2000å­—å®Œæ•´æŠ¥å‘Šï¼ˆå¯å‚è€ƒLevel 4ï¼‰
- æ™ºèƒ½ç¼“å­˜æœºåˆ¶ï¼ˆé¿å…é‡å¤ç”Ÿæˆï¼‰
- ç»“æ„åŒ–è¾“å‡ºï¼ˆåŒ…å«å…³é”®ç‚¹ã€ç« èŠ‚ç»“æ„ã€å»ºè®®ç­‰ï¼‰
- æ”¯æŒå•çº§åˆ«ç”Ÿæˆå’Œå…¨éƒ¨çº§åˆ«æ‰¹é‡ç”Ÿæˆ

**APIç«¯ç‚¹**: 
- `POST /api/v1/aag/summary` ï¼ˆå•çº§åˆ«ï¼‰
- `POST /api/v1/aag/summary/all` ï¼ˆå…¨éƒ¨çº§åˆ«ï¼‰

### 4. çŸ¥è¯†å›¾è°±æ„å»ºåŠŸèƒ½ (KnowledgeGraphAgent)
**å®Œæˆæ—¶é—´**: 2025-07-14

**åŠŸèƒ½ç‰¹æ€§**:
- ä¸‰ç§æå–æ¨¡å¼
  - Quick: å¿«é€Ÿæå–5-10ä¸ªæ ¸å¿ƒå®ä½“
  - Focused: èšç„¦ç‰¹å®šç±»å‹å®ä½“ï¼ˆå¦‚åªæå–äººç‰©å’Œç»„ç»‡ï¼‰
  - Comprehensive: å…¨é¢æ·±å…¥æå–ï¼ˆæ”¯æŒé•¿æ–‡æ¡£åˆ†å—ï¼‰
- æ”¯æŒçš„å®ä½“ç±»å‹
  - äººç‰© (person)
  - ç»„ç»‡ (organization)
  - æ¦‚å¿µ (concept)
  - æŠ€æœ¯ (technology)
  - åœ°ç‚¹ (location)
  - äº‹ä»¶ (event)
  - äº§å“ (product)
- æ”¯æŒçš„å…³ç³»ç±»å‹
  - å®šä¹‰ (defines)
  - åŒ…å« (contains)
  - å½±å“ (influences)
  - å¯¹æ¯” (contrasts)
  - ä½¿ç”¨ (uses)
  - åˆ›å»º (creates)
  - å±äº (belongs_to)
  - ç›¸å…³ (related_to)
- åå¤„ç†èƒ½åŠ›
  - å®ä½“å»é‡å’Œæ ‡å‡†åŒ–
  - å…³ç³»éªŒè¯ï¼ˆç¡®ä¿å®ä½“å­˜åœ¨ï¼‰
  - ç»Ÿè®¡åˆ†æï¼ˆæ ¸å¿ƒèŠ‚ç‚¹ã€ç±»å‹åˆ†å¸ƒç­‰ï¼‰
- å¯¼å‡ºåŠŸèƒ½
  - Neo4j Cypherè¯­å¥
  - JSONæ ¼å¼

**APIç«¯ç‚¹**:
- `POST /api/v1/aag/knowledge-graph` ï¼ˆæ„å»ºï¼‰
- `POST /api/v1/aag/knowledge-graph/export` ï¼ˆå¯¼å‡ºï¼‰

### 5. è¾…åŠ©åŠŸèƒ½
- âœ… åˆ†æç‰©æ–™ç®¡ç†ï¼ˆä¿å­˜å’Œæ£€ç´¢åˆ†æç»“æœï¼‰
- âœ… å…ƒæ•°æ®ç®¡ç†ï¼ˆè·Ÿè¸ªåˆ†æçŠ¶æ€å’Œç»Ÿè®¡ä¿¡æ¯ï¼‰
- âœ… ç¼“å­˜æœºåˆ¶ï¼ˆæé«˜é‡å¤åˆ†æçš„æ•ˆç‡ï¼‰

## å½“å‰é—®é¢˜ä¸ä¼˜åŒ–å»ºè®® ğŸ”§

### 1. çŸ¥è¯†å›¾è°±å…³ç³»æå–é—®é¢˜
**é—®é¢˜**: æµ‹è¯•ä¸­å‘ç°è™½ç„¶èƒ½æˆåŠŸæå–å®ä½“ï¼Œä½†å…³ç³»æå–æ•°é‡ç»å¸¸ä¸º0ã€‚

**åŸå› åˆ†æ**:
- LLMè¿”å›çš„JSONæ ¼å¼å¯èƒ½ä¸ç¬¦åˆé¢„æœŸ
- Promptä¸­çš„ç¤ºä¾‹å¯èƒ½ä¸å¤Ÿæ¸…æ™°
- å…³ç³»æå–çš„æŒ‡ä»¤å¯èƒ½éœ€è¦åŠ å¼º

**å»ºè®®ä¼˜åŒ–**:
- æ”¹è¿›promptæ¨¡æ¿ï¼Œæä¾›æ›´æ¸…æ™°çš„å…³ç³»æå–ç¤ºä¾‹
- æ·»åŠ JSONæ ¼å¼éªŒè¯å’Œä¿®å¤æœºåˆ¶
- è€ƒè™‘åˆ†ä¸¤æ­¥æå–ï¼šå…ˆæå–å®ä½“ï¼Œå†ä¸“é—¨æå–å…³ç³»

### 2. æ€§èƒ½ä¼˜åŒ–ç©ºé—´
- å¤§æ–‡æ¡£å¤„ç†æ—¶çš„åˆ†å—ç­–ç•¥å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–
- å¯ä»¥å®ç°æ‰¹é‡å¤„ç†ä»¥æé«˜ååé‡
- ç¼“å­˜ç­–ç•¥å¯ä»¥æ›´æ™ºèƒ½ï¼ˆå¦‚åŸºäºæ–‡æ¡£ç›¸ä¼¼åº¦ï¼‰

## æ­£åœ¨å¼€å‘çš„åŠŸèƒ½ ğŸš§

### 1. å¤šç»´å¤§çº²æå– (OutlineAgent)
**è®¡åˆ’åŠŸèƒ½**:
- é€»è¾‘å¤§çº²ï¼šå±•ç¤ºæ–‡æ¡£çš„ç« èŠ‚ç»“æ„å’Œè®ºè¿°æµç¨‹
- ä¸»é¢˜å¤§çº²ï¼šè¯†åˆ«æ ¸å¿ƒæ¦‚å¿µå’Œä¸»é¢˜ç½‘ç»œ
- æ—¶é—´çº¿å¤§çº²ï¼šæå–æ—¶åºä¿¡æ¯å’Œäº‹ä»¶è„‰ç»œ
- å› æœé“¾å¤§çº²ï¼šåˆ†æåŸå› -ç»“æœå…³ç³»

### 2. æ·±åº¦åˆ†æAgenté›†åˆ
- è¯æ®é“¾è¿½è¸ªï¼šéªŒè¯è®ºç‚¹çš„æ”¯æ’‘è¯æ®
- äº¤å‰å¼•ç”¨åˆ†æï¼šè¿½è¸ªæ¦‚å¿µåœ¨ä¸åŒç« èŠ‚çš„è¡¨è¿°
- æ‰¹åˆ¤æ€§æ€ç»´åˆ†æï¼šè¯†åˆ«å‡è®¾ã€åè§å’Œé€»è¾‘æ¼æ´

## ä½¿ç”¨ç»Ÿè®¡ ğŸ“Š

åŸºäºæµ‹è¯•è¿è¡Œçš„æ•°æ®ï¼š

| åŠŸèƒ½ | å¹³å‡æ‰§è¡Œæ—¶é—´ | Tokenä½¿ç”¨é‡ | ç¼“å­˜å‘½ä¸­æå‡ |
|------|------------|-----------|------------|
| å¿«é€Ÿç•¥è¯» | 3-5ç§’ | 500-800 | N/A |
| Level 2æ‘˜è¦ | 5-8ç§’ | 600-1000 | 100x |
| çŸ¥è¯†å›¾è°±(Quick) | 8-12ç§’ | 600-800 | 50x |
| çŸ¥è¯†å›¾è°±(Comprehensive) | 20-30ç§’ | 1500-2000 | 30x |

## é›†æˆå»ºè®® ğŸ’¡

### 1. ä¸ç°æœ‰DPAç³»ç»Ÿé›†æˆ
- åœ¨æ–‡æ¡£ä¸Šä¼ åè‡ªåŠ¨è§¦å‘å¿«é€Ÿç•¥è¯»
- åŸºäºç•¥è¯»ç»“æœçš„è´¨é‡è¯„åˆ†å†³å®šæ˜¯å¦è¿›è¡Œæ·±åº¦åˆ†æ
- çŸ¥è¯†å›¾è°±å¯ä»¥å­˜å…¥Neo4jè¿›è¡ŒæŒä¹…åŒ–å’ŒæŸ¥è¯¢

### 2. å‰ç«¯å±•ç¤ºå»ºè®®
- ç•¥è¯»ç»“æœå¯ä»¥ä½œä¸ºæ–‡æ¡£å¡ç‰‡çš„é¢„è§ˆä¿¡æ¯
- æ¸è¿›å¼æ‘˜è¦å¯ä»¥å®ç°ç±»ä¼¼"é˜…è¯»æ›´å¤š"çš„äº¤äº’
- çŸ¥è¯†å›¾è°±å¯ä»¥ä½¿ç”¨D3.jsæˆ–Cytoscape.jså¯è§†åŒ–

### 3. å·¥ä½œæµé›†æˆ
```python
# æ¨èçš„åˆ†ææµç¨‹
async def analyze_document(document):
    # 1. å¿«é€Ÿç•¥è¯»ï¼Œè¯„ä¼°æ–‡æ¡£
    skim_result = await skim_document(document)
    
    # 2. åŸºäºè´¨é‡è¯„åˆ†å†³å®šåˆ†ææ·±åº¦
    if skim_result.quality_score > 0.7:
        # é«˜è´¨é‡æ–‡æ¡£ï¼Œè¿›è¡Œæ·±åº¦åˆ†æ
        summaries = await generate_all_summaries(document)
        knowledge_graph = await build_knowledge_graph(
            document, mode="comprehensive"
        )
    else:
        # ä¸€èˆ¬æ–‡æ¡£ï¼Œå¿«é€Ÿåˆ†æ
        summary = await generate_summary(document, level="level_2")
        knowledge_graph = await build_knowledge_graph(
            document, mode="quick"
        )
    
    return analysis_results
```

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨è®¡åˆ’ ğŸ“‹

### çŸ­æœŸï¼ˆ1å‘¨å†…ï¼‰
1. ä¼˜åŒ–çŸ¥è¯†å›¾è°±çš„å…³ç³»æå–èƒ½åŠ›
2. å®ç°å¤šç»´å¤§çº²æå–Agent
3. å¼€å§‹æ·±åº¦åˆ†æAgentçš„å¼€å‘

### ä¸­æœŸï¼ˆ2-3å‘¨ï¼‰
1. å®Œæˆæ‰€æœ‰æ·±åº¦åˆ†æAgent
2. å®ç°PlannerAgentå’ŒSynthesizerAgent
3. å¼€å§‹LangGraphç¼–æ’å¼•æ“çš„è®¾è®¡

### é•¿æœŸï¼ˆ1ä¸ªæœˆï¼‰
1. å®Œæˆå®Œæ•´çš„åˆ†ææµæ°´çº¿
2. ä¼˜åŒ–æ€§èƒ½å’Œèµ„æºä½¿ç”¨
3. æä¾›è¡Œä¸šç‰¹å®šçš„åˆ†ææ¨¡æ¿

## æ€»ç»“

AAGæ¨¡å—çš„åŸºç¡€åŠŸèƒ½å·²ç»å®Œæˆï¼Œèƒ½å¤Ÿæä¾›ä»å¿«é€Ÿé¢„è§ˆåˆ°æ·±åº¦åˆ†æçš„å¤šå±‚æ¬¡æ–‡æ¡£å¤„ç†èƒ½åŠ›ã€‚æ¥ä¸‹æ¥çš„é‡ç‚¹æ˜¯ï¼š
1. è§£å†³ç°æœ‰çš„æŠ€æœ¯é—®é¢˜ï¼ˆå¦‚å…³ç³»æå–ï¼‰
2. å®Œæˆé«˜çº§åˆ†æåŠŸèƒ½çš„å¼€å‘
3. å®ç°æ™ºèƒ½çš„åˆ†ææµç¨‹ç¼–æ’

é€šè¿‡è¿™äº›åŠªåŠ›ï¼ŒAAGå°†æˆä¸ºDPAç³»ç»Ÿä¸­çœŸæ­£çš„"æ™ºèƒ½å¤§è„‘"ï¼Œä¸ºç”¨æˆ·æä¾›æœ‰ä»·å€¼çš„çŸ¥è¯†æ´å¯Ÿã€‚